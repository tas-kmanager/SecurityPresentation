# Reference Document 
From Unveilling the Not-PowerShell Cult Presentation



## Not-PowerShell Tools

### InvisiShell

* Github: InvisiShell - https://github.com/OmerYa/Invisi-Shell
* DerbyCon 2018: InvisiShell Presentation - http://www.irongeek.com/i.php?page=videos/derbycon8/track-3-15-goodbye-obfuscation-hello-invisi-shell-hiding-your-powershell-script-in-plain-sight-omer-yair

### PowerShDLL

* Github: PowerShDLL - https://github.com/p3nt4/PowerShdll

### PowerLessShell

* Github: PowerLessShell - https://github.com/Mr-Un1k0d3r/PowerLessShell

### NoPowerShell

* Github: NoPowerShell - https://github.com/bitsadmin/nopowershell
* Medium: NoPowerShell Cobalt Strike Detection (Olaf Hartong) - https://medium.com/@olafhartong/cobalt-strike-remote-threads-detection-206372d11d0f
* F-Secure: Detecting Malicious .NET Part 1 - https://blog.f-secure.com/detecting-malicious-use-of-net-part-1/
* F-Secure: Detecting Malicious .NET Part 2 - https://blog.f-secure.com/detecting-malicious-use-of-net-part-2/

### PowerLine

* Github: PowerLine - https://github.com/fullmetalcache/PowerLine

### SharpPick

* Github: SharpPick - https://github.com/TheKevinWang/SharpPick

## Logging Tools

### Windows Logs
* Microsoft: Windows Event Log - https://docs.microsoft.com/en-us/windows/win32/wes/windows-event-log
* Microsoft: Using Windows Event Log - https://docs.microsoft.com/en-us/windows/win32/wes/using-windows-event-log

### SysInternal Sysmon
* Microsoft: Download Sysmon - https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon
* Binary Defense: Sysmon and ETW - https://www.binarydefense.com/using-sysmon-and-etw-for-so-much-more/

### Event Tracing For Windows (ETW)

* Microsoft: Adding ETW to Message Analyzer - https://docs.microsoft.com/en-us/message-analyzer/adding-a-system-etw-provider
* Palantir: Tampering with ETW - https://medium.com/palantir/tampering-with-windows-event-tracing-background-offense-and-defense-4be7ac62ac63
* Microsoft: Intrusion Detection with ETW Part 1 - https://blogs.technet.microsoft.com/office365security/hidden-treasure-intrusion-detection-with-etw-part-1/
* Microsoft: Intrusion Detection with ETW Part 2 - https://blogs.technet.microsoft.com/office365security/hidden-treasure-intrusion-detection-with-etw-part-2/
* Microsoft: ETW in CLR - https://docs.microsoft.com/en-us/dotnet/framework/performance/etw-events-in-the-common-language-runtime
* DerbyCon 2017: Detecting Attacks with ETW - http://www.irongeek.com/i.php?page=videos/derbycon7/s25-tracing-adversaries-detecting-attacks-with-etw-matt-hastings-dave-hull


## PowerShell Related Information

### General Usage

* DarkOperator: PowerShell Basic - https://www.darkoperator.com/powershellbasics

### Blue Team Usage 

* Crowdstrike: Investigating PowerShell - https://www.crowdstrike.com/blog/investigating-powershell-command-and-script-logging/
* Microsoft: PowerShell Love the Blue Team - https://devblogs.microsoft.com/powershell/powershell-the-blue-team/
* Rapid7: Defending against PowerShell Attack - https://blog.rapid7.com/2018/09/27/the-powershell-boogeyman-how-to-defend-against-malicious-powershell-attacks/
* NSFocusGlobal: Attack and Defense Powershell - https://nsfocusglobal.com/Attack-and-Defense-Around-PowerShell-Event-Logging
* HoldMyBeerSecurity: Detecting Empire - https://holdmybeersecurity.com/2019/02/27/sysinternals-for-windows-incident-response/

### Red Team Usage
* IReadTeam: PowerShell without PowerShell - https://ired.team/offensive-security/code-execution/powershell-without-powershell
* Github: Empire - https://github.com/EmpireProject/Empire
* Github: PowerCat - https://github.com/besimorhino/powercat
* Github: PowerSploit - https://github.com/PowerShellMafia/PowerSploit
* Github: Sherlock - https://github.com/rasta-mouse/Sherlock
* Github: Watson - https://github.com/rasta-mouse/Watson
* Github: Nishang - https://github.com/samratashok/nishang
* Github: PowerThief - https://github.com/nettitude/Invoke-PowerThIEf

### APTs and Malware 
* FireEye: APT29 - https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html
* TrendMicro: Cobalt Group - https://blog.trendmicro.com/trendlabs-security-intelligence/cobalt-spam-runs-use-macros-cve-2017-8759-exploit/
* CarbonBlack: Emotet - https://www.carbonblack.com/2019/04/24/cb-tau-threat-intelligence-notification-emotet-utilizing-wmi-to-launch-powershell-encoded-code/


## Mitre Att&ck
* Mitre: T1086 PowerShell https://attack.mitre.org/techniques/T1086/



